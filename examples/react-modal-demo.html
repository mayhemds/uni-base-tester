<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Status Modal Demo</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Mock DatabaseStatusModal component for demo
        const DatabaseStatusModal = ({ config, showOnStartup = true, onClose }) => {
            const [isVisible, setIsVisible] = useState(showOnStartup);
            const [status, setStatus] = useState('testing');
            const [message, setMessage] = useState('Testing database connection...');
            const [details, setDetails] = useState('');

            React.useEffect(() => {
                // Simulate database test
                setTimeout(() => {
                    const success = Math.random() > 0.3; // 70% success rate for demo
                    if (success) {
                        setStatus('connected');
                        setMessage('Database connected successfully!');
                        setDetails('Connection verified in 245ms');
                        setTimeout(() => setIsVisible(false), 3000);
                    } else {
                        setStatus('failed');
                        setMessage('Database connection failed');
                        setDetails('Connection timeout after 30000ms');
                    }
                }, 2000);
            }, []);

            const handleRetry = () => {
                setStatus('testing');
                setMessage('Testing database connection...');
                setDetails('');
                setTimeout(() => {
                    setStatus('connected');
                    setMessage('Database connected successfully!');
                    setDetails('Connection verified in 189ms');
                    setTimeout(() => setIsVisible(false), 3000);
                }, 1500);
            };

            const handleClose = () => {
                setIsVisible(false);
                if (onClose) onClose();
            };

            if (!isVisible) return null;

            const modalStyles = {
                overlay: {
                    position: 'fixed',
                    top: 0,
                    left: 0,
                    right: 0,
                    bottom: 0,
                    backgroundColor: 'transparent',
                    display: 'flex',
                    alignItems: 'flex-end',
                    justifyContent: 'flex-end',
                    zIndex: 1000,
                    pointerEvents: 'none',
                },
                modal: {
                    backgroundColor: 'white',
                    borderRadius: '8px',
                    padding: '1.5rem',
                    width: '350px',
                    maxWidth: '350px',
                    boxShadow: '0 4px 12px rgba(0, 0, 0, 0.15)',
                    fontFamily: 'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',
                    border: '1px solid #e1e5e9',
                    margin: '20px',
                    animation: 'slideInUp 0.3s ease-out',
                    pointerEvents: 'auto',
                },
                header: {
                    display: 'flex',
                    alignItems: 'center',
                    marginBottom: '1rem',
                    paddingBottom: '0.75rem',
                    borderBottom: '1px solid #e1e5e9',
                },
                trafficLight: {
                    width: '12px',
                    height: '12px',
                    borderRadius: '50%',
                    marginRight: '0.75rem',
                    backgroundColor: status === 'connected' ? '#22c55e' : status === 'failed' ? '#ef4444' : '#f59e0b',
                    animation: status === 'testing' ? 'pulse 2s infinite' : 'none',
                },
                icon: {
                    fontSize: '1rem',
                    marginRight: '0.75rem',
                    display: 'flex',
                    alignItems: 'center',
                    color: status === 'connected' ? '#22c55e' : status === 'failed' ? '#ef4444' : '#6b7280',
                    fontWeight: '600',
                },
                title: {
                    margin: 0,
                    fontSize: '1.1rem',
                    fontWeight: '500',
                    color: '#374151',
                },
                message: {
                    fontSize: '0.95rem',
                    marginBottom: '0.75rem',
                    fontWeight: '400',
                    color: '#6b7280',
                    lineHeight: '1.4',
                },
                details: {
                    fontSize: '0.8rem',
                    color: '#9ca3af',
                    marginBottom: '1rem',
                    padding: '0.5rem',
                    backgroundColor: '#f8fafc',
                    borderRadius: '4px',
                    border: '1px solid #e2e8f0',
                    fontFamily: 'monospace',
                },
                buttons: {
                    display: 'flex',
                    gap: '0.5rem',
                    justifyContent: 'flex-end',
                },
                button: {
                    padding: '0.5rem 1rem',
                    borderRadius: '4px',
                    border: '1px solid #d1d5db',
                    cursor: 'pointer',
                    fontSize: '0.8rem',
                    fontWeight: '400',
                    transition: 'all 0.15s ease',
                    backgroundColor: 'white',
                },
                dangerButton: {
                    backgroundColor: '#ef4444',
                    color: 'white',
                    border: '1px solid #ef4444',
                },
                secondaryButton: {
                    backgroundColor: 'white',
                    color: '#6b7280',
                    border: '1px solid #d1d5db',
                },
            };

            const getIcon = () => {
                switch (status) {
                    case 'testing': return (
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" style={{animation: 'spin 2s linear infinite'}}>
                            <path d="M21 12a9 9 0 11-6.219-8.56"/>
                        </svg>
                    );
                    case 'connected': return 'âœ“';
                    case 'failed': return '!';
                    default: return '?';
                }
            };

            const getTitle = () => {
                switch (status) {
                    case 'testing': return 'Testing Connection';
                    case 'connected': return 'Connected';
                    case 'failed': return 'Connection Failed';
                    default: return 'Database Status';
                }
            };

            return (
                <>
                    <style>{`
                        @keyframes slideInUp {
                            from { opacity: 0; transform: translateY(20px); }
                            to { opacity: 1; transform: translateY(0); }
                        }
                        @keyframes spin {
                            from { transform: rotate(0deg); }
                            to { transform: rotate(360deg); }
                        }
                        @keyframes pulse {
                            0%, 100% { opacity: 1; }
                            50% { opacity: 0.5; }
                        }
                    `}</style>
                    <div style={modalStyles.overlay}>
                        <div style={modalStyles.modal}>
                            <div style={modalStyles.header}>
                                <div style={modalStyles.trafficLight}></div>
                                <span style={modalStyles.icon}>{getIcon()}</span>
                                <h2 style={modalStyles.title}>{getTitle()}</h2>
                            </div>
                            
                            <div style={modalStyles.message}>{message}</div>
                            
                            {details && (
                                <div style={modalStyles.details}>{details}</div>
                            )}
                            
                            <div style={modalStyles.buttons}>
                                {status === 'failed' && (
                                    <button
                                        style={{ ...modalStyles.button, ...modalStyles.dangerButton }}
                                        onClick={handleRetry}
                                    >
                                        Retry Connection
                                    </button>
                                )}
                                <button
                                    style={{ ...modalStyles.button, ...modalStyles.secondaryButton }}
                                    onClick={handleClose}
                                >
                                    Close
                                </button>
                            </div>
                        </div>
                    </div>
                </>
            );
        };

        const App = () => {
            const [showModal, setShowModal] = useState(false);

            const config = {
                database: {
                    type: 'postgresql',
                    connectionString: 'postgresql://user:pass@localhost:5432/testdb'
                }
            };

            return (
                <div style={{ padding: '2rem', fontFamily: 'system-ui' }}>
                    <h1>Database Status Modal Demo</h1>
                    <p>This demonstrates the uni-database-tester React modal component.</p>
                    
                    <button 
                        onClick={() => setShowModal(true)}
                        style={{
                            padding: '0.75rem 1.5rem',
                            backgroundColor: '#3b82f6',
                            color: 'white',
                            border: 'none',
                            borderRadius: '6px',
                            cursor: 'pointer',
                            fontSize: '1rem',
                            fontWeight: '500'
                        }}
                    >
                        Test Database Connection
                    </button>

                    {showModal && (
                        <DatabaseStatusModal 
                            config={config}
                            showOnStartup={true}
                            onClose={() => setShowModal(false)}
                        />
                    )}
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
